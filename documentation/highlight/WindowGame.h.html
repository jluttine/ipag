<pre><tt><span style="font-weight: bold"><span style="color: #000080">#ifndef</span></span> _WINDOW_GAME_H_
<span style="font-weight: bold"><span style="color: #000080">#define</span></span> _WINDOW_GAME_H_

<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">"Window.h"</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">"GameEngine.h"</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">"UIText.h"</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">"UIButton.h"</span>

<span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * WindowGame is the actual game window.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * @author Tapio Auvinen</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> WindowGame  <span style="color: #990000">:</span>  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> Window <span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Constructor.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * @param &amp;graphics Reference to graphics</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * @param &amp;sounds Reference to sound engine</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * @param &amp;engine Reference to game engine</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="font-weight: bold"><span style="color: #000000">WindowGame</span></span><span style="color: #990000">(</span>Graphics <span style="color: #990000">&amp;</span>graphics<span style="color: #990000">,</span> Sounds <span style="color: #990000">&amp;</span>sounds<span style="color: #990000">,</span> GameEngine <span style="color: #990000">&amp;</span>engine<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Destructor</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #990000">~</span><span style="font-weight: bold"><span style="color: #000000">WindowGame</span></span><span style="color: #990000">(</span><span style="color: #990000">)</span><span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Opens game window and starts the game.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">open</span></span><span style="color: #990000">(</span><span style="color: #990000">)</span><span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Step function is called periodically by Window::open(). It makes the</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * game move.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * @param timestep timestep in milliseconds</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">step</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> timestep<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Handles key down events</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">keyDown</span></span><span style="color: #990000">(</span>SDL_keysym keysym<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Handles mouse move events</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">mouseMove</span></span><span style="color: #990000">(</span>SDL_MouseMotionEvent motion<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Handles mouse down events.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">mouseDown</span></span><span style="color: #990000">(</span>SDL_MouseButtonEvent button<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Handles mouse up events.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">mouseUp</span></span><span style="color: #990000">(</span>SDL_MouseButtonEvent button<span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>

    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Refreshes UI. Game engine calls this when there is a significant</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * change in it's state. </span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * @param wnd Pointer to game window. This is a static callback</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     *            function so 'this' is not available and we have to</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     *            receive it as parameter.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">uiCallback</span></span><span style="color: #990000">(</span><span style="color: #009900">void</span> <span style="color: #990000">*</span>wnd<span style="color: #990000">)</span><span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Ends the game and closes this window.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">endGame</span></span><span style="color: #990000">(</span><span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Updates player name and weapon info.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">updateSidebar</span></span><span style="color: #990000">(</span><span style="color: #990000">)</span><span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * Updates score. Energy bars are not UI components so they have to be</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     * redrawn every refresh.</span></span>
<span style="font-style: italic"><span style="color: #9A1900">     */</span></span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">updateScore</span></span><span style="color: #990000">(</span><span style="color: #990000">)</span><span style="color: #990000">;</span>
    

    GameEngine <span style="color: #990000">&amp;</span>gameEngine<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">//Reference to game engine</span></span>
    <span style="color: #009900">bool</span> scrollMode<span style="color: #990000">;</span>      <span style="font-style: italic"><span style="color: #9A1900">//Tells whether we are scrolling or not</span></span>
    <span style="color: #009900">bool</span> moveMode<span style="color: #990000">;</span>       <span style="font-style: italic"><span style="color: #9A1900">//'select new location' mode</span></span>
    <span style="color: #009900">float</span> dragDistance<span style="color: #990000">;</span>  <span style="font-style: italic"><span style="color: #9A1900">//Odometer for scrolling</span></span>

    <span style="color: #009900">int</span> parameterIndex<span style="color: #990000">;</span>  <span style="font-style: italic"><span style="color: #9A1900">//Currently selected weapon parameter</span></span>

    
    <span style="font-style: italic"><span style="color: #9A1900">//UI components:</span></span>
    UIText <span style="color: #990000">*</span>textPlayer<span style="color: #990000">;</span>  <span style="font-style: italic"><span style="color: #9A1900">//Player in turn</span></span>
    
    UIText <span style="color: #990000">*</span>textPlayers<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">//All players and their</span></span>
    UIText <span style="color: #990000">*</span>textScore<span style="color: #990000">;</span>   <span style="font-style: italic"><span style="color: #9A1900">//score</span></span>
    
    <span style="font-style: italic"><span style="color: #9A1900">//Weapon:</span></span>
    UIText <span style="color: #990000">*</span>textWeapon<span style="color: #990000">;</span>
    UIText <span style="color: #990000">*</span>textAmmo<span style="color: #990000">;</span>
    UIButton <span style="color: #990000">*</span>butWeaponNext<span style="color: #990000">;</span>
    UIButton <span style="color: #990000">*</span>butWeaponPrev<span style="color: #990000">;</span>
    
    <span style="font-style: italic"><span style="color: #9A1900">//Weapon parameters:</span></span>
    UIText <span style="color: #990000">*</span>textParamTitle<span style="color: #990000">;</span>
    UIText <span style="color: #990000">*</span>textParamValue<span style="color: #990000">;</span>
    UIButton <span style="color: #990000">*</span>butParamNext<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">//Select parameter</span></span>
    UIButton <span style="color: #990000">*</span>butParamPrev<span style="color: #990000">;</span>
    UIButton <span style="color: #990000">*</span>butParamIncr<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">//Adjust parameter value</span></span>
    UIButton <span style="color: #990000">*</span>butParamDecr<span style="color: #990000">;</span>
    
    UIButton <span style="color: #990000">*</span>butMove<span style="color: #990000">;</span>  <span style="font-style: italic"><span style="color: #9A1900">//Select new location</span></span>
    UIButton <span style="color: #990000">*</span>butQuit<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000080">#endif</span></span> <span style="font-style: italic"><span style="color: #9A1900">//_WINDOW_GAME_H_</span></span>
</tt></pre>
